var _g=(typeof(window)!=="undefined")?window:global;_g.$JOII={REVISION:23,PublicAPI:{Class:function(b,a){if(!a){a=b;b={}}return(new _g.$JOII.ClassBuilder(b,a))},Interface:function(b,a){if(!a){a=b;b={}}return(new _g.$JOII.InterfaceBuilder(b,a))},Service:function(b,c,a){if(typeof(_g.$JOII.Services[b])!=="undefined"){throw new Error('Another service with the name "'+b+'" is already defined.')}_g.$JOII.Services[b]={object:c,instance:undefined,arguments:a}},RegisterJOIIPlugin:function(a,b){_g.$JOII.Plugins[a]={compile:b.compile||function(){},supports:b.supports||function(){return true},scope:b.scope||{}}}},PublicClassAPI:{"super":function(e){var b=Array.prototype.slice.call(arguments,1),a=this,d=this.__joii__,c=function(h,k,g){if(typeof(h)==="undefined"){throw new Error('Parent method "'+k+'" does not exist.')}if(typeof(h.__joii__.parent)!=="undefined"&&typeof(h.__joii__.parent.prototype[k])==="undefined"){return c(h.__joii__.parent,k,g)}if(typeof(h.__joii__.parent)==="undefined"){throw new Error('Method "'+k+'" does not exist.')}var f=h.__joii__.parent.prototype[k];a.__joii__=h.__joii__.parent.prototype.__joii__;var j=f.apply(a,g);a.__joii__=d;return j};return c(this,e,b)},instanceOf:function(b){if(typeof(b.__joii__)!=="undefined"){b=b.__joii__.clean_prototype}if(typeof(b.__interface__)!=="undefined"){return _g.$JOII.Compat.indexOf(this.__joii__.interfaces,b.__interface__)!==-1}var a=function(e,c){var d=e;if(typeof(e.__joii__)!=="undefined"){e=e.__joii__.clean_prototype}if(e===c){return true}if(typeof(d.__joii__)!=="undefined"){if(typeof(d.__joii__.parent)!=="undefined"){return a(d.__joii__.parent,c)}}return d===c};return a(this,b)},getService:function(a){return _g.$JOII.System.getService(a)}},Plugins:{},Interfaces:{},Services:{},Namespace:{},RegisterInNS:function(b,a){_g.$JOII.Namespace[b]=a},InterfaceBuilder:function(e,a){var d={};var c=_g.$JOII.System.guid()();for(var b in a){if(typeof(a[b])!=="string"){throw new Error("An interface definition must be a string, defining the property type.")}d[b]=a[b]}_g.$JOII.Compat.CreateProperty(d,"__interface__",c);_g.$JOII.Interfaces[c]=d;if(typeof(e["extends"])==="object"&&!!e["extends"].__interface__){d=_g.$JOII.System.ExtendInterface(d,e["extends"])}return d},ClassBuilder:function(e,a){if(typeof(a)!=="object"){throw new Error("Class body must be an Object, "+typeof(a)+"given")}var d=_g.$JOII.System.ApplyPrototype(function(){var o=function(){},k=null;var j=_g.$JOII.Compat.extend(true,{},Object.create(this));o.prototype=j;d=Object.create(new o());_g.$JOII.Compat.CreateProperty(d,"__joii__",this.__joii__);for(k in _g.$JOII.PublicClassAPI){if(typeof(d.i)!=="undefined"){throw new Error('Method "'+k+'" is reserved by JOII.')}_g.$JOII.Compat.CreateProperty(d,k,_g.$JOII.PublicClassAPI[k])}_g.$JOII.System.ApplyPlugins(d,a);if(typeof(d.__construct)==="function"){var m=d.__construct.apply(d,arguments);if(typeof(m)==="object"){o={};for(k in m){if(typeof(m[k])==="function"){o[k]=m[k].bind(d)}else{o[k]=m[k]}}_g.$JOII.Compat.CreateProperty(o,"__joii__",this.__joii__);_g.$JOII.Compat.CreateProperty(o,a,_g.$JOII.PublicClassAPI[k]);_g.$JOII.System.ApplyPlugins(o,a);if(typeof(d.__joii__.interfaces)!=="undefined"&&this.__joii__.interfaces.length>0){for(k in d.__joii__.interfaces){if(typeof(d.__joii__.interfaces[k])==="undefined"){continue}var n=_g.$JOII.Interfaces[d.__joii__.interfaces[k]];for(var g in n){if(n.hasOwnProperty(g)&&typeof(o[g])!==n[g]){throw new Error("Public API must implement "+n[g]+' "'+g+'" as defined in the interface the class implements.')}}}}return o}}for(var h in d.__joii__.implementation_list){var l=d.__joii__.implementation_list[h];if(typeof(d[h])!==l&&h.charAt(0)!=="_"&&h.charAt(1)!=="_"&&typeof(l)==="string"){if(typeof(d[h])==="undefined"){throw new Error("Class is missing "+l+' implementation of property "'+h+'".')}else{throw new Error('Property "'+h+'" must be of type "'+l+'", '+typeof(h)+" detected.")}}}return d},a);if(typeof(e["extends"])==="function"&&typeof(e["extends"].prototype)==="object"){d=_g.$JOII.System.ApplyParent(d,e["extends"])}else{if(typeof(e["extends"])==="object"){d=_g.$JOII.System.ApplyTrait(d,e["extends"])}else{if(typeof(e["extends"])!=="undefined"){throw new Error("Parent class must be a function containing a prototype.")}}}if(typeof(e.uses)!=="undefined"){if(typeof(e.uses[0])==="undefined"){i=e.uses;e.uses=[i]}for(i in e.uses){if(typeof(e.uses[i])==="object"){for(var c in e.uses[i]){var b=e.uses[i][c];if(typeof(d.prototype[c])==="undefined"){d.prototype[c]=b}}}}}if(typeof(e["implements"])!=="undefined"&&typeof(e["implements"][0])==="undefined"){i=e["implements"];e["implements"]=[];e["implements"].push(i)}e["implements"]=e["implements"]||[];d.__joii__["implements"]=e["implements"];d.__joii__.interfaces=[];_g.$JOII.System.ApplyInterfaces(d);d.__joii__.clean_prototype=a;_g.$JOII.Compat.CreateProperty(d.prototype,"__joii__",d.__joii__);return d},System:{getService:function(j){if(typeof(_g.$JOII.Services[j])==="undefined"){throw new Error('Service "'+j+'" is not defined.')}if(typeof(_g.$JOII.Services[j].instance)==="undefined"){var c=_g.$JOII.Services[j].object;var a=c.prototype.__construct;var f=[];var h=function(m,l){var k=[];k[j]=function(){return m.apply(this,l)};k[j].prototype=m.prototype;return new k[j]()};if(typeof(a)!=="undefined"){var b=function(m){var l=m.toString().replace(/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg,"");var k=l.slice(l.indexOf("(")+1,l.indexOf(")")).match(/([^\s,]+)/g);if(k===null){k=[]}return k}(a);var e=_g.$JOII.Services[j].arguments;for(var d in b){var g=e[b[d]];if(typeof(g)==="string"&&g.charAt(0)==="@"){g=_g.$JOII.System.getService(g.substring(1,g.length))}f.push(g)}}_g.$JOII.Services[j].instance=h(c,f)}return _g.$JOII.Services[j].instance},ApplyPrototype:function(c,a){_g.$JOII.Compat.CreateProperty(c,"__joii__",{});for(var b in a){c.prototype[b]=a[b]}return c},ApplyParent:function(c,b){c.__joii__.parent={};c.__joii__.parent.prototype=b.prototype;if(typeof(b.__joii__)==="object"){c.__joii__.parent.__joii__=b.__joii__}for(var a in b.prototype){if(typeof(c.prototype[a])==="undefined"){c.prototype[a]=b.prototype[a]}}return c},ApplyTrait:function(e,b){if(typeof(Object.getOwnPropertyNames)!=="undefined"){var d=Object.getOwnPropertyNames(b);for(var a in d){if(typeof(e.prototype[d[a]])==="undefined"){e.prototype[d[a]]=Math[d[a]]}}}else{for(var c in b){if(typeof(e.prototype[c])==="undefined"){e.prototype[c]=b[c]}}}return e},ApplyPlugins:function(f,c){tmp_product=_g.$JOII.Compat.extend(true,{},f);tmp_product.prototype=tmp_product;for(var e in _g.$JOII.Plugins){if(!_g.$JOII.Plugins[e].supports(tmp_product)){continue}f.prototype=f;if(undefined!==(p=_g.$JOII.Plugins[e].compile(f))){if(typeof(p.prototype)!=="undefined"){p=p.prototype}f=p}if(typeof(f.prototype)!=="undefined"){delete f.prototype}for(var b in _g.$JOII.Plugins[e].scope){if(typeof(f[b])!=="undefined"){if(typeof(c[b])!=="undefined"){throw new Error('Method "'+b+'" is reserved by plugin "'+e+'".')}for(var d in _g.$JOII.Plugins){for(var a in _g.$JOII.Plugins[d].scope){if(a===b&&e!==d){throw new Error('Method "'+b+'" from plugin "'+e+'" is already in use by plugin "'+d+'".')}}}}f[b]=_g.$JOII.Plugins[e].scope[b]}}},ApplyInterfaces:function(a){var b=function(g,e){e=e||{};for(var f in g.__joii__["implements"]){a.__joii__.interfaces.push(g.__joii__["implements"][f].__interface__);for(var d in g.__joii__["implements"][f]){e[d]=g.__joii__["implements"][f][d]}}if(typeof(g.__joii__.parent)!=="undefined"){var h=b(g.__joii__.parent,e);for(f in h){e[f]=h[f]}}return e};a.__joii__.implementation_list=b(a)},ExtendInterface:function(c,a){var b=c.__interface__;for(var d in a){if(c.hasOwnProperty(d)){continue}c[d]=a[d]}_g.$JOII.Interfaces[b]=c;return c},guid:function(){function a(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return function(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}}},Compat:{isArray:function(c){var b=c.length,a=typeof(c);if(a==="function"||(typeof(window)!=="undefined"&&c===window)){return false}if(c.nodeType===1&&b){return true}return Object.prototype.toString.call(c)==="[object Array]"},extend:function(){var k,a,c,g=false,h,f=arguments[0]||{},e=1,d=arguments.length,j=false;if(typeof f==="boolean"){j=f;f=arguments[e]||{};e++}if(typeof f!=="object"&&typeof(f)!=="function"){f={}}for(;e<d;e++){if((k=arguments[e])!==null&&arguments[e]!==undefined){for(var b in k){a=f[b];c=k[b];if(f===c){continue}if(j&&c&&(_g.$JOII.Compat.isPlainObject(c)||(g=_g.$JOII.Compat.isArray(c)))){if(g){g=false;h=a&&_g.$JOII.Compat.isArray(a)?a:[]}else{h=a&&_g.$JOII.Compat.isPlainObject(a)?a:{}}f[b]=_g.$JOII.Compat.extend(j,h,c)}else{if(c!==undefined){f[b]=c}}}}}return f},isPlainObject:function(b){var a=({}).hasOwnProperty;if(typeof(b)!=="object"||b.nodeType||(typeof(window)!=="undefined"&&b===window)){return false}if(b.constructor&&!a.call(b.constructor.prototype,"isPrototypeOf")){return false}return true},indexOf:function(c,b){for(var a in c){if(c[a]===b){return a}}return -1},CreateNamespaceObject:function(c,d){var a=window||global,e=c.split("."),b;while(e.length>0){b=e.shift();if(typeof(a[b])==="undefined"){a[b]={}}if(typeof(d)!=="undefined"&&e.length===0){a[b]=d;return a}a=a[b]}return a},CreateProperty:function(c,a,d){try{if(typeof(Object.defineProperty)!=="undefined"){Object.defineProperty(c,a,{writable:true,enumerable:false,value:d})}else{c[a]=d}}catch(b){c[a]=d}}},initialize:function(){var c;if(typeof(window)==="undefined"&&typeof(module)!=="undefined"){module.exports=_g.$JOII.PublicAPI;c=_g}else{var a=document.getElementsByTagName("script"),d=a[a.length-1];if(!(c=d.getAttribute("data-ns"))){c=_g}if(typeof(c)==="string"){c=_g.$JOII.Compat.CreateNamespaceObject(c)}}for(var b in _g.$JOII.PublicAPI){if(_g.$JOII.PublicAPI.hasOwnProperty(b)){c[b]=_g.$JOII.PublicAPI[b]}}_g.$JOII.Namespace=c}};if(typeof(Object.create)==="undefined"){Object.create=(function(){function a(){}return function(b){if(arguments.length!=1){throw new Error("Object.create implementation only accepts one parameter.")}a.prototype=b;return new a()}})()}if(!Function.prototype.bind){Function.prototype.bind=function(a){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")}var e=Array.prototype.slice.call(arguments,1),d=this,b=function(){},c=function(){return d.apply(this instanceof b&&a?this:a,e.concat(Array.prototype.slice.call(arguments)))};b.prototype=this.prototype;c.prototype=new b();return c}}_g.$JOII.initialize();